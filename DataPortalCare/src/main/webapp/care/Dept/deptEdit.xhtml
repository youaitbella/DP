<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:pf="http://primefaces.org/ui">


    <ui:define name="title">Mitteilung gem. § 5 PpUGV</ui:define>

    <ui:define name="content">

        <style>
            .card {
                max-width: 1600px !important;
            }

            /* Loader */

            .inekLoader {
                display: inline-block;
                position: relative;
                width: 64px;
                height: 64px;
            }

            .inekLoader div {
                animation: inekLoader 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
                transform-origin: 32px 32px;
            }

            .inekLoader div:after {
                content: " ";
                display: block;
                position: absolute;
                width: 6px;
                height: 6px;
                border-radius: 50%;
                background: #000000;
                margin: -3px 0 0 -3px;
            }

            .inekLoader div:nth-child(1) {
                animation-delay: -0.036s;
            }

            .inekLoader div:nth-child(1):after {
                top: 50px;
                left: 50px;
            }

            .inekLoader div:nth-child(2) {
                animation-delay: -0.072s;
            }

            .inekLoader div:nth-child(2):after {
                top: 54px;
                left: 45px;
            }

            .inekLoader div:nth-child(3) {
                animation-delay: -0.108s;
            }

            .inekLoader div:nth-child(3):after {
                top: 57px;
                left: 39px;
            }

            .inekLoader div:nth-child(4) {
                animation-delay: -0.144s;
            }

            .inekLoader div:nth-child(4):after {
                top: 58px;
                left: 32px;
            }

            .inekLoader div:nth-child(5) {
                animation-delay: -0.18s;
            }

            .inekLoader div:nth-child(5):after {
                top: 57px;
                left: 25px;
            }

            .inekLoader div:nth-child(6) {
                animation-delay: -0.216s;
            }

            .inekLoader div:nth-child(6):after {
                top: 54px;
                left: 19px;
            }

            .inekLoader div:nth-child(7) {
                animation-delay: -0.252s;
            }

            .inekLoader div:nth-child(7):after {
                top: 50px;
                left: 14px;
            }

            .inekLoader div:nth-child(8) {
                animation-delay: -0.288s;
            }

            .inekLoader div:nth-child(8):after {
                top: 45px;
                left: 10px;
            }

            @keyframes inekLoader {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }
        </style>

        <script type="text/javascript">
            function start() {
                PF('dialogProcess').show();
            }

            function stop() {
                PF('dialogProcess').hide();
            }
        </script>

        <pf:dialog widgetVar="dialogProcess"
                   header="Exceldatei wird generiert"
                   modal="true"
                   closable="false"
                   resizable="false"
                   height="80px">
            <div style="text-align: center; width: 100%;">
                <div class="inekLoader" style="text-align: center;">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
            </div>
        </pf:dialog>


        <h:form id="form">
            <div style="margin-top: 10px;">
                <pf:commandButton value="Zurück zur Übersicht"
                                  icon="fa fa-arrow-left"
                                  action="#{sessionController.navigate(sessionTools.pages.CareDeptSummary)}"
                                  immediate="true" />

                <pf:button target="blank"
                           value="Hilfe?"
                           icon="fa fa-info"
                           href="https://www.g-drg.de/Umsetzung_der_Verordnung_zur_Festlegung_von_Pflegepersonaluntergrenzen_in_pflegesensitiven_Bereichen_in_Krankenhaeusern_PpUGV/FAQ" />
            </div>

            <ui:include src="deptStation.xhtml" />

            <div class="ui-g">
                <div class="card">
                    <div class="ui-g-12">

                        <pf:commandButton value="Datensatz ändern"
                                          action="#{deptEdit.change()}"
                                          rendered="#{deptEdit.changeAllowed()}"
                                          style="margin-left: 10px;"
                                          update="@(.ui-message) @form" />

                        <pf:commandButton value="Meldung exportieren (Excel)"
                                          ajax="false"
                                          rendered="#{deptEdit.changeAllowed()}"
                                          style="margin-left: 10px;"
                                          onclick="PrimeFaces.monitorDownload(start, stop);"
                                          icon="ui-icon-arrowthick-1-s">
                            <pf:fileDownload value="#{deptEdit.exportAsExcel()}" />
                        </pf:commandButton>

                        <pf:commandButton value="Speichern ohne Senden"
                                          action="#{deptEdit.save()}"
                                          rendered="#{!deptEdit.isReadOnly}"
                                          style="margin-left: 10px;"
                                          update="@(.ui-message) @form" />

                        <pf:commandButton value="Meldung abschließend ans InEK senden"
                                          action="#{deptEdit.send()}"
                                          rendered="#{!deptEdit.isReadOnly}"
                                          styleClass="green-button"
                                          style="margin-left: 10px;"
                                          icon="fa fa-arrow-right"
                                          iconPos="right"
                                          update="@(.ui-message) @form" />

                    </div>
                </div>
            </div>
        </h:form>

    </ui:define>

</ui:composition>

