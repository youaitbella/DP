<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:pf="http://primefaces.org/ui"
                xmlns:inekIk="http://xmlns.jcp.org/jsf/composite/components/Other"
                xmlns:inekInput="http://xmlns.jcp.org/jsf/composite/components/Input"
                xmlns:inekIcon="http://xmlns.jcp.org/jsf/composite/components/Icons"
                xmlns:inekOutput="http://xmlns.jcp.org/jsf/composite/components/Output"
                xmlns:jsf="http://xmlns.jcp.org/jsf">

    <style>

        /* InfoBox */

        .inekInfoBox {
            width: 100%;
            text-align: center;
            margin-top: 5px;
            margin-bottom: 5px;
            padding-top: 5px;
            padding-bottom: 5px;
            background-color: #209e53;
            position: relative;
            color: white;
            font-size: 1.2em;
        }

        .inekInfoBox:before {
            content: "\f05a";
            font-family: FontAwesome;
        }

    </style>

    <div class="ui-g">
        <div class="card">
            <div class="ui-g-12">
                <inekIk:MultiIk_V2 label="#{msg.lblIkShort}"
                                   required="true"
                                   value="#{deptEdit.deptBaseInformation.ik}"
                                   ikList="#{deptEdit.validIks}"
                                   readonly="#{deptEdit.isReadOnly}"
                                   listener="#{deptEdit.ikChanged()}"
                                   isFixed="#{deptEdit.deptBaseInformation.id gt 0}"
                                   updateElement="form"/>

            </div>


            <div class="ui-g-12" jsf:rendered="#{deptEdit.getDeptsByArea(1).size() gt 0}">

                <h1>Angaben zu § 3 Abs. 2 Nr. 1 FAB</h1>
                <pf:repeat value="#{deptEdit.getDeptsByArea(1)}" var="dept">
                    <h4>Stationsangaben für #{dept.deptName}</h4>
                    <div class="inekInfoBox" jsf:rendered="#{!dept.required}">
                        Keine Angabe erforderlich
                    </div>
                    <pf:dataTable id="depTable"
                                  value="#{dept.deptStations}"
                                  emptyMessage="Noch keine Stationen erfasst"
                                  var="station">
                        <pf:column class="colIcon" style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteStationFromDept(dept, station)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form"/>
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{station.stationName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                        <pf:column headerText="Standort">
                            <inekInput:InputText value="#{station.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Station zur #{dept.deptName} hinzufügen"
                                      actionListener="#{deptEdit.addNewStation(dept)}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTable"/>

                </pf:repeat>

            </div>

            <div class="ui-g-12" jsf:rendered="#{deptEdit.getDeptsByArea(2).size() gt 0}">

                <h1>Angaben zu § 3 Abs. 2 Nr. 2 DRG-Liste</h1>

                <pf:repeat value="#{deptEdit.getDeptsByArea(2)}" var="dept">
                    <h4>Stationsangaben für #{dept.deptName}</h4>
                    <div class="inekInfoBox" jsf:rendered="#{!dept.required}">
                        Keine Angabe erforderlich
                    </div>
                    <pf:dataTable id="depTable"
                                  value="#{dept.deptStations}"
                                  emptyMessage="Noch keine Stationen erfasst"
                                  var="station">
                        <pf:column style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteStationFromDept(dept, station)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form"/>
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{station.stationName}"
                                                 Style="width: 100%;"
                                                 require="true"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}"
                                                 updateComponents="form"/>
                        </pf:column>
                        <pf:column headerText="Standort">
                            <inekInput:InputText value="#{station.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Station zur #{dept.deptName} hinzufügen"
                                      actionListener="#{deptEdit.addNewStation(dept)}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTable"/>
                </pf:repeat>

            </div>

            <div class="ui-g-12" jsf:rendered="#{deptEdit.getDeptsByArea(3).size() gt 0}">

                <h1>Angaben zu § 3 Abs. 2 Nr. 3 OPS</h1>

                <pf:repeat value="#{deptEdit.getDeptsByArea(3)}" var="dept">
                    <h4>Stationsangaben für #{dept.deptName}</h4>
                    <div class="inekInfoBox" jsf:rendered="#{!dept.required}">
                        Keine Angabe erforderlich
                    </div>
                    <pf:dataTable id="depTable"
                                  value="#{dept.deptStations}"
                                  emptyMessage="Noch keine Stationen erfasst"
                                  var="station">
                        <pf:column class="colIcon" style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteStationFromDept(dept, station)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form"/>
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{station.stationName}"
                                                 Style="width: 100%;"
                                                 require="true"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}"
                                                 updateComponents="form"/>
                        </pf:column>
                        <pf:column headerText="Standort">
                            <inekInput:InputText value="#{station.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Station zur #{dept.deptName} hinzufügen"
                                      actionListener="#{deptEdit.addNewStation(dept)}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTable"/>
                </pf:repeat>
            </div>

            <div class="ui-g-12">
                <pf:fieldset legend="Veränderte Werte ab 2018 eintragen"
                             collapsed="true"
                             toggleable="true">

                    <pf:dataTable id="depTableAfterTargetYear"
                                  value="#{deptEdit.deptBaseInformation.deptsAftertargetYear}"
                                  emptyMessage="Noch keine Einträge vorhanden"
                                  var="deptAfterTargetYear">
                        <pf:column class="colIcon" style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteDeptAfterTargetYear(deptAfterTargetYear)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form"/>
                        </pf:column>
                        <pf:column headerText="Sensitiver Bereich">
                            <inekInput:InputText value="#{deptAfterTargetYear.sensitiveArea}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie den Bereich an"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                        <pf:column headerText="Fachabteilungsschlüssel">
                            <inekInput:InputText value="#{deptAfterTargetYear.deptNumber}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie einen Fachabteilungsschlüssel"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                        <pf:column headerText="Fachabteilungsname">
                            <inekInput:InputText value="#{deptAfterTargetYear.deptName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie einen Fachabteilungsnamen ein"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{deptAfterTargetYear.stationName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                        <pf:column headerText="Standort">
                            <inekInput:InputText value="#{deptAfterTargetYear.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}"/>
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Neuen Eintrag"
                                      actionListener="#{deptEdit.addNewDeptAfterTargetYear()}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTableAfterTargetYear"/>

                </pf:fieldset>
            </div>
        </div>
    </div>

</ui:composition>

