<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:pf="http://primefaces.org/ui"
                xmlns:inekIk="http://xmlns.jcp.org/jsf/composite/components/Other"
                xmlns:inekInput="http://xmlns.jcp.org/jsf/composite/components/Input"
                xmlns:inekIcon="http://xmlns.jcp.org/jsf/composite/components/Icons"
                xmlns:jsf="http://xmlns.jcp.org/jsf">


    <pf:dialog header="Fachabteilungsauswahl"
               widgetVar="dlgFabSelection"
               modal="true"
               width="800px">
        <h:outputText value="Für welche Fachabteilung wollen Sie eine Änderung eintragen?" />

        <br />

        <pf:repeat value="#{deptEdit.deptBaseInformation.depts}" var="dept">

            <div class="ui-g">
                <div class="ui-g-10">
                    <pf:outputLabel rendered="#{dept.deptArea ne 3}" value="#{dept.deptNumber} - #{dept.deptName}" />
                    <pf:outputLabel rendered="#{dept.deptArea eq 3}" value="#{dept.sensitiveArea}" />
                </div>
                <div class="ui-g-2">
                    <pf:commandButton value="Auswählen"
                                      action="#{deptEdit.addNewDeptAfterTargetYear(dept)}"
                                      update="@form" />
                </div>
            </div>

        </pf:repeat>

    </pf:dialog>

    <style>

        /* InfoBox */

        .inekInfoBox {
            width: 100%;
            text-align: center;
            margin-top: 5px;
            margin-bottom: 5px;
            padding-top: 5px;
            padding-bottom: 5px;
            background-color: #209e53;
            position: relative;
            color: white;
            font-size: 1.2em;
        }

        .inekInfoBox:before {
            content: "\f05a";
            font-family: FontAwesome;
        }

    </style>

    <div class="ui-g">
        <div class="card">
            <div class="ui-g-12">
                <inekIk:MultiIk_V2 label="#{msg.lblIkShort}"
                                   required="true"
                                   value="#{deptEdit.deptBaseInformation.ik}"
                                   ikList="#{deptEdit.validIks}"
                                   readonly="#{deptEdit.isReadOnly}"
                                   listener="#{deptEdit.ikChanged()}"
                                   isFixed="#{deptEdit.deptBaseInformation.id gt 0}"
                                   updateElement="form" />

            </div>

            <div class="ui-g-12" jsf:rendered="#{deptEdit.getDeptsByArea(1).size() gt 0}">

                <h1>Angaben zu § 3 Abs. 3 Satz 2 Nr. 1 PpUGV (ausgewiesene Fachabteilung)</h1>
                <pf:repeat value="#{deptEdit.getDeptsByArea(1)}" var="dept">
                    <h3>Stationsangaben für pflegeintensiven Bereich #{dept.sensitiveArea}: Fachabteilung #{dept.deptNumber} #{dept.deptName}</h3>
                    <div class="inekInfoBox" jsf:rendered="#{!dept.required}">
                        Keine Angabe erforderlich
                    </div>
                    <pf:dataTable id="depTable"
                                  value="#{dept.deptStations}"
                                  emptyMessage="Keine Einträge vorhanden"
                                  var="station">
                        <pf:column class="colIcon" style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteStationFromDept(dept, station)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form" />
                        </pf:column>
                        <pf:column headerText="Fachabteilungsname">
                            <inekInput:InputText value="#{station.deptName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie den Fachabteilungsnamen aus Ihrem Haus ein"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{station.stationName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                        <pf:column headerText="Standort" style="width: 100px;">
                            <inekInput:InputText value="#{station.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Station hinzufügen"
                                      actionListener="#{deptEdit.addNewStation(dept)}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTable" />

                </pf:repeat>

            </div>

            <br />

            <div class="ui-g-12" jsf:rendered="#{deptEdit.getDeptsByArea(2).size() gt 0}">

                <h1>Angaben zu § 3 Abs. 2 3 Satz Nr. 2 PpUGV (Indikatoren - DRGs)</h1>

                <pf:repeat value="#{deptEdit.getDeptsByArea(2)}" var="dept">
                    <h3>Stationsangaben für pflegeintensiven Bereich #{dept.sensitiveArea}: Fachabteilung #{dept.deptNumber} #{dept.deptName}</h3>
                    <div class="inekInfoBox" jsf:rendered="#{!dept.required}">
                        Keine Angabe erforderlich
                    </div>
                    <pf:dataTable id="depTable"
                                  value="#{dept.deptStations}"
                                  emptyMessage="Keine Einträge vorhanden"
                                  var="station">
                        <pf:column style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteStationFromDept(dept, station)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form" />
                        </pf:column>
                        <pf:column headerText="Fachabteilungsname">
                            <inekInput:InputText value="#{station.deptName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie den Fachabteilungsnamen aus Ihrem Haus ein"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{station.stationName}"
                                                 Style="width: 100%;"
                                                 require="true"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}"
                                                 updateComponents="form" />
                        </pf:column>
                        <pf:column headerText="Standort" style="width: 100px;">
                            <inekInput:InputText value="#{station.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Station hinzufügen"
                                      actionListener="#{deptEdit.addNewStation(dept)}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTable" />
                </pf:repeat>

            </div>

            <br />

            <div class="ui-g-12" jsf:rendered="#{deptEdit.getDeptsByArea(3).size() gt 0}">

                <h1>Angaben zu § 3 Abs. 4 PpUGV (OPS-Liste Intensivmedizin)</h1>

                <pf:repeat value="#{deptEdit.getDeptsByArea(3)}" var="dept">
                    <h3>Stationsangaben für pflegeintensiven Bereich #{dept.sensitiveArea}</h3>
                    <div class="inekInfoBox" jsf:rendered="#{!dept.required}">
                        Keine Angabe erforderlich
                    </div>
                    <pf:dataTable id="depTable"
                                  value="#{dept.deptStations}"
                                  emptyMessage="Keine Einträge vorhanden"
                                  var="station">
                        <pf:column class="colIcon" style="width: 20px;">
                            <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteStationFromDept(dept, station)}"
                                                 show="#{!deptEdit.isReadOnly}"
                                                 updateElement="form" />
                        </pf:column>
                        <pf:column headerText="Fachabteilungsnr." style="width: 120px;">
                            <inekInput:InputText value="#{station.deptName}"
                                                 Style="width: 100%;"
                                                 maxlength="4"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                        <pf:column headerText="Fachabteilungsname">
                            <inekInput:InputText value="#{station.deptName}"
                                                 require="true"
                                                 Style="width: 100%;"
                                                 requiredMessage="Bitte geben Sie den Fachabteilungsnamen aus Ihrem Haus ein"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                        <pf:column headerText="Stationsbezeichnung">
                            <inekInput:InputText value="#{station.stationName}"
                                                 Style="width: 100%;"
                                                 require="true"
                                                 requiredMessage="Bitte geben Sie einen aussagekräftigen Stationsnamen an"
                                                 readonly="#{deptEdit.isReadOnly}"
                                                 updateComponents="form" />
                        </pf:column>
                        <pf:column headerText="Standort" style="width: 100px;">
                            <inekInput:InputText value="#{station.locationCode}"
                                                 Style="width: 100%;"
                                                 readonly="#{deptEdit.isReadOnly}" />
                        </pf:column>
                    </pf:dataTable>

                    <pf:commandButton value="Station hinzufügen"
                                      actionListener="#{deptEdit.addNewStation(dept)}"
                                      process="@this"
                                      immediate="false"
                                      rendered="#{!deptEdit.isReadOnly}"
                                      style="margin-top: 10px;"
                                      icon="fa fa-plus"
                                      update="depTable" />
                </pf:repeat>
            </div>

            <br />

            <div class="ui-g-12" jsf:rendered="#{deptEdit.deptBaseInformation.ik > 0}">

                <h1>Umbenennung oder strukturelle Veränderungen (§ 5 Abs. 4 PpUGV)</h1>

                <pf:dataTable id="depTableAfterTargetYear"
                              value="#{deptEdit.stationsAfterTargetYear}"
                              emptyMessage="Noch keine Einträge vorhanden"
                              var="deptAfterTargetYear">

                    <pf:columnGroup type="header">
                        <pf:row>
                            <pf:column style="width: 20px;" headerText="" />
                            <pf:column colspan="4" headerText="2017" style="border-right-width:5px;" />
                            <pf:column colspan="6" headerText="Nach 2017" />
                        </pf:row>
                        <pf:row>
                            <pf:column style="width: 20px;" headerText="" />
                            <pf:column headerText="Fachabteilung" />
                            <pf:column headerText="Fachabteilung gem. KH" />
                            <pf:column headerText="Station" />
                            <pf:column headerText="Standort" style="border-right-width:5px;" />
                            <pf:column headerText="PS Bereich" />
                            <pf:column headerText="FAB - Nummer" />
                            <pf:column headerText="FAB Name" />
                            <pf:column headerText="Station" />
                            <pf:column headerText="Standort" />
                            <pf:column headerText="Anmerkung" />
                        </pf:row>

                    </pf:columnGroup>
                    <pf:column class="colIcon" style="width: 20px;">
                        <inekIcon:DeleteIcon deleteFunction="#{deptEdit.deleteDeptAfterTargetYear(deptAfterTargetYear)}"
                                             show="#{!deptEdit.isReadOnly}"
                                             updateElement="form" />
                    </pf:column>
                    <pf:column headerText="Fachabteilung">
                        <pf:outputLabel
                                value="#{deptAfterTargetYear.dept.deptNumber} - #{deptAfterTargetYear.dept.deptName}" />
                    </pf:column>
                    <pf:column headerText="Fachabteilung gem. KH">
                        <inekInput:InputText value="#{deptAfterTargetYear.deptNameHospital}"
                                             require="true"
                                             Style="width: 100%;"
                                             requiredMessage="Bitte geben Sie den Fachabteilungsnamen an"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="Station">
                        <inekInput:InputText value="#{deptAfterTargetYear.stationNameTargetYear}"
                                             require="true"
                                             Style="width: 100%;"
                                             requiredMessage="Bitte geben Sie die Station an"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="Standort" style="border-right-width:5px;">
                        <inekInput:InputText value="#{deptAfterTargetYear.locationCodeTargetYear}"
                                             Style="width: 100%;"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="PS Bereich">
                        <inekInput:InputText value="#{deptAfterTargetYear.sensitiveArea}"
                                             Style="width: 100%;"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="FAB - Nummer">
                        <inekInput:InputText value="#{deptAfterTargetYear.deptNumber}"
                                             maxlength="4"
                                             Style="width: 100%;"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="FAB Name">
                        <inekInput:InputText value="#{deptAfterTargetYear.deptName}"
                                             Style="width: 100%;"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="Station">
                        <inekInput:InputText value="#{deptAfterTargetYear.stationName}"
                                             Style="width: 100%;"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="Standort">
                        <inekInput:InputText value="#{deptAfterTargetYear.locationCode}"
                                             Style="width: 100%;"
                                             readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                    <pf:column headerText="Anmerkung">
                        <pf:inputTextarea value="#{deptAfterTargetYear.comment}"
                                          rows="1"
                                          style="width: 100%;"
                                          readonly="#{deptEdit.isReadOnly}" />
                    </pf:column>
                </pf:dataTable>

                <pf:commandButton value="Neuen Eintrag"
                                  onclick="PF('dlgFabSelection').show();"
                                  immediate="false"
                                  rendered="#{!deptEdit.isReadOnly}"
                                  style="margin-top: 10px;"
                                  icon="fa fa-plus"
                                  update="depTableAfterTargetYear" />
            </div>
        </div>
    </div>

</ui:composition>

