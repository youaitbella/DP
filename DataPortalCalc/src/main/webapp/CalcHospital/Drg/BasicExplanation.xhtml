<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components/common"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:cb="http://inek.org/dataportal/clientbehaviour">

    <h2>Erklärung zur Kalkulationsgrundlage</h2>

    <table cellspacing="6">
        <thead>
        <th>Bezeichnung</th>
        <th>#{editCalcBasicsDrg.calcBasics.dataYear}</th>
        <th>#{editCalcBasicsDrg.calcBasics.dataYear-1}</th>
        <th>Abweichung</th>
        </thead>
        <tr>
            <td>
                <span class="label">#{msg.lblSumCalcCost}</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.sumCalcCost}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="sumCalcCosts"
                                      renderElement="@this pDiffSumCalcCost :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.priorCalcBasics.sumCalcCost}"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      disabled="true"
                                      id="pSumCalcCost"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffSumCalcCost">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                          value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.sumCalcCost, editCalcBasicsDrg.calcBasics.sumCalcCost)}"
                                          readonly="#{editCalcBasicsDrg.readOnly}"
                                          disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">Erlösvolumen</span>
            </td>
            <td>
                <inek:InputIntegerWithMessage styleClass="inputwide"
                                              value="#{editCalcBasicsDrg.calcBasics.redeemingVolume}"
                                              required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              title="Bitte geben Sie das Erlösvolumen ohne Erlösausgleiche für alle Abteilungsarten an."
                                              id="redeemingVolume"
                                              renderElement="@this pDiffredeemingVolume :logout:remaining"
                />
            </td>
            <td>
                <inek:InputIntegerWithMessage styleClass="inputwide"
                                              value="#{editCalcBasicsDrg.priorCalcBasics.redeemingVolume}"
                                              disabled="true"
                                              id="predeemingVolume"
                />
            </td>
            <td>
                <h:panelGroup id="pDiffredeemingVolume">
                    <inek:InputIntegerWithMessage styleClass="inputwide"
                                                  value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.redeemingVolume, editCalcBasicsDrg.calcBasics.redeemingVolume)}"
                                                  disabled="true"
                    />
                </h:panelGroup>
            </td>
        </tr>
        <tr>
            <td>
                <span class="label">Anzahl kalkulationsrelevanter Fälle</span>
            </td>
            <td>
            </td>
            <td>
            </td>
            <td>
            </td>
        </tr>
        <tr>
            <td>
                <span class="label">Fälle vollstationär</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.caseInStationCnt}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="fullCases"
                                      renderElement="@this pDiffCaseInstationCount :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.priorCalcBasics.caseInStationCnt}"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="pCaseInstationCount"
                                      disabled="true"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffCaseInstationCount">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                         value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.caseInStationCnt, editCalcBasicsDrg.calcBasics.caseInStationCnt)}" 
                                         disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">Fälle teilstationär</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.casePartialStationCnt}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="halfCases"
                                      renderElement="@this pDiffPartialStationCount :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.priorCalcBasics.casePartialStationCnt}"
                                     disabled="true"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffPartialStationCount">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                         value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.casePartialStationCnt, editCalcBasicsDrg.calcBasics.casePartialStationCnt)}"
                                         disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">Fälle Belegabteilung</span>
            </td>
            <td>
                <inek:InputIntegerWithMessage styleClass="inputwide"
                                              value="#{editCalcBasicsDrg.calcBasics.caseBaCnt}"
                                              required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              id="baCases"
                                              renderElement="@this pDiffbaCount :logout:remaining"
                />
            </td>
            <td>
                <inek:InputIntegerWithMessage styleClass="inputwide"
                                              value="#{editCalcBasicsDrg.priorCalcBasics.caseBaCnt}"
                                              disabled="true"
                />
            </td>
            <td>
                <h:panelGroup id="pDiffbaCount">
                    <inek:InputIntegerWithMessage styleClass="inputwide"
                                                  value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.caseBaCnt, editCalcBasicsDrg.calcBasics.caseBaCnt)}"
                                                  disabled="true"
                    />
                </h:panelGroup>
            </td>
        </tr>
        <tr>
            <td>
                <span class="label">Berechnungstage teilstationär</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.daysPartialStation}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="halfCalcDays"
                                      renderElement="@this pDiffHalfCalcDays :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.priorCalcBasics.daysPartialStation}"
                                     id="pHalfCalcDays"
                                     disabled="true"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffHalfCalcDays">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                         value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.daysPartialStation, editCalcBasicsDrg.calcBasics.daysPartialStation)}"
                                         disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">Begleitpersonen</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.patientEscort}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="companions"
                                      renderElement="@this pPatientEscort pDiffPatientEscort :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.priorCalcBasics.patientEscort}"
                                     disabled="true"
                                     id="pPatientEscort"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffPatientEscort">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                         value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.patientEscort, editCalcBasicsDrg.calcBasics.patientEscort)}"
                                         disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">rein vorstationär</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.preStation}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      id="onlyStationary"
                                      renderElement="@this pDiffPreStation :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.priorCalcBasics.preStation}"
                                     disabled="true"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffPreStation">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                         value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.preStation, editCalcBasicsDrg.calcBasics.preStation)}"
                                         disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">Betten (DRG-Bereich)</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.beds}"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      required="true"
                                      renderElement="@this pDiffBeds :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.priorCalcBasics.beds}"
                                     disabled="true"
                                     />
        </td>
        <td>
        <h:panelGroup id="pDiffBeds">
            <inek:InputIntegerWithMessage styleClass="inputwide"
                                         value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.beds, editCalcBasicsDrg.calcBasics.beds)}"
                                         disabled="true"
                                         />
        </h:panelGroup>
        </td>
        </tr>
        <tr>
            <td>
                <span class="label">Anzahl teilstationäre Plätze (DRG-Bereich)</span>
            </td>
            <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                      value="#{editCalcBasicsDrg.calcBasics.partialCnt}"
                                      required="true"
                                      readonly="#{editCalcBasicsDrg.readOnly}"
                                      renderElement="@this pDiffPartialCnt :logout:remaining"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.priorCalcBasics.partialCnt}"
                                     disabled="true"
                                     />
        </td>
        <td>
        <inek:InputIntegerWithMessage styleClass="inputwide"
                                     value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.priorCalcBasics.partialCnt, editCalcBasicsDrg.calcBasics.partialCnt)}"
                                     disabled="true"
                                     />
        </td>
        </tr>
        <tbody>

        </tbody>
    </table>

    <h2>Entlassender Standort</h2>

    <div class="inputPart">
        <h:outputLabel styleClass="label" value="Anzahl Standorte:" /> &nbsp;
        <h:inputText id="locationCnt" styleClass="inputshort" value="#{editCalcBasicsDrg.calcBasics.locationCnt}"
                     readonly="#{editCalcBasicsDrg.readOnly}"
                     validatorMessage="Fachabteilung eingeben"
                     required="true">
            <f:validateLength minimum="1"/>
            <f:ajax event="blur" render="@form :logout:remaining locationCntMsg" listener="#{editCalcBasicsDrg.changeLocationCount}"/>
        </h:inputText>
        <h:message for="locationCnt" styleClass="errorMessage" id="locationCntMsg"/>
    </div>

    <div class="inputPart">
        <inek:BooleanRadioButton label="Liegt ein nach Standorten differenzierter Versorgungsauftrag vor:"
                                 value="#{editCalcBasicsDrg.calcBasics.difLocationSupply}"
                                 readonly="#{editCalcBasicsDrg.readOnly}"
                                 renderElement="@form"
                                 labelStyle="label"/>
    </div>

    <h:panelGroup styleClass="inputPart" rendered="#{!editCalcBasicsDrg.calcBasics.difLocationSupply}">
        Obwohl Sie "nein" angegeben haben, möchten wir Sie dennoch bitten, die Differenzierung im Datenfeld "entlassender    
        Standort" des übermittelten §21-Datensatzes vorzunehmen und die Standorte in der nachfolgenden Tabelle zu benennen. 
        Wir möchten Sie darauf hinweisen, dass die Differenzierung der Standorte lediglich für die Plausibilisierung der 
        Kalkulationsdaten verwendet wird. Eine Weitergabe dieser Angaben im Zuge der Datenlieferung nach § 21 Abs. 3 KHEntgG
        wird nicht erfolgen.
    </h:panelGroup>
    
    <h:dataTable  headerClass="list-header" id="exitLocation"
                  value="#{editCalcBasicsDrg.calcBasics.locations}" var="item" width="70%" rowClasses="row1, row2" 
                  columnClasses="#{editCalcBasicsDrg.calcBasics.locations.size() gt editCalcBasicsDrg.calcBasics.locationCnt ? 'colIcon,' : ''} col90, colShort"
                  rendered="true"
                  >

        <h:column rendered="#{editCalcBasicsDrg.calcBasics.locations.size() gt editCalcBasicsDrg.calcBasics.locationCnt}">
            <f:facet name="header">
                <h:outputText value=""/>
            </f:facet>
            <h:commandLink styleClass="colIcon">
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png"
                                rendered="#{!editCalcBasicsDrg.readOnly}"
                                title="#{msg.btnDelete}" value=""/>
                <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteLocation(item)}"/>
                <cb:confirmDelete/>
            </h:commandLink>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputText value="Entlassender Standort (aussagekräftiger Name)"/><br/>
            </f:facet>
            <h:inputText id="location" value="#{item.location}" styleClass="inputwide"
                         readonly="#{editCalcBasicsDrg.readOnly}"
                         required="true">
                <f:ajax event="blur" render="@this :logout:remaining locationMsg"/>
            </h:inputText>
            <h:message for="location" styleClass="errorMessage" id="locationMsg"/>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputText value="Nummer"/>
            </f:facet>
            <h:inputText id="locationNo" value="#{item.locationNo}" styleClass="inputwide"
                         readonly="#{editCalcBasicsDrg.readOnly}"
                         required="true">
                <f:ajax event="blur" render="@this :logout:remaining locationNoMsg"/>
            </h:inputText>
            <h:message for="locationNo" styleClass="errorMessage" id="locationNoMsg"/>
        </h:column>

    </h:dataTable>
    
    <h:commandLink id="addButtonLocation" styleClass="addButton inputPart" value="#{msg.btnAddEntry}" rendered="#{!editCalcBasicsDrg.readOnly}">
        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addLocation()}"/>
    </h:commandLink>
    
    <h2>Besondere Einrichtungen (BE)</h2>

    <div class="inputPart">
        <inek:BooleanRadioButton label="Besteht für das Krankenhaus (bzw. eine Fachabteilung) eine Vereinbarung einer/mehrerer Besonderen(r) Einrichtung(en) nach den Regelungen der VBE #{editCalcBasicsDrg.calcBasics.dataYear}:"
                                 renderElement="@form :script" value="#{editCalcBasicsDrg.calcBasics.specialUnit}"
                                 readonly="#{editCalcBasicsDrg.readOnly}"
                                 labelStyle="label"
                                 listener="#{sessionController.hideData(editCalcBasicsDrg.calcBasics.specialUnit)}">
        </inek:BooleanRadioButton>
    </div>

    <h:panelGroup id="special" rendered="#{editCalcBasicsDrg.calcBasics.specialUnit}">
        <h:dataTable headerClass="list-header"
                      value="#{editCalcBasicsDrg.calcBasics.specialUnits}" var="item" width="70%" rowClasses="row1, row2" 
                      columnClasses="colIcon, col03, col03, col03"
                      rendered="true"
                      >

            <h:column>
                <f:facet name="header">
                    <h:outputText value=""/>
                </f:facet>
                <h:commandLink styleClass="colIcon">
                    <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png"
                                    rendered="#{!editCalcBasicsDrg.readOnly}"
                                    title="#{msg.btnDelete}" value=""/>
                    <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteSpecialUnit(item)}"/>
                </h:commandLink>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Art der BE"/><br/>
                </f:facet>
                <h:inputText id="type" value="#{item.type}" styleClass="inputwide"
                             readonly="#{editCalcBasicsDrg.readOnly}"
                             required="true">
                    <f:ajax event="blur" render="@this :logout:remaining typeMsg"/>
                </h:inputText>
                <h:message for="type" styleClass="errorMessage" id="typeMsg"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Fallzahl"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.caseCnt}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Kostenvolumen"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.cost}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

        </h:dataTable>

        <h:commandLink id="addButtonSpecial" styleClass="addButton inputPart"
                       rendered="#{!editCalcBasicsDrg.readOnly}"
                       value="#{msg.btnAddEntry}">
            <f:ajax event="click" render="calcBasics:special :logout:remaining"
                    listener="#{editCalcBasicsDrg.addSpecialUnit()}"/>
        </h:commandLink>
    </h:panelGroup>

    <h2>Zentren und Schwerpunkte gem. § 2 Abs. 2 Satz 2 Nr. 4 KHEntgG</h2>

    <div class="inputPart">
        <inek:BooleanRadioButton label="Besteht eine gesondert vereinbarte Vergütung für Zentren und Schwerpunkte gem. § 2 Abs. 2 Satz 2 Nr. 4 KHEntgG:"
                                 renderElement="@form :script"
                                 readonly="#{editCalcBasicsDrg.readOnly}"
                                 value="#{editCalcBasicsDrg.calcBasics.centralFocus}"
                                 labelStyle="label"
                                 listener="#{sessionController.hideData(editCalcBasicsDrg.calcBasics.centralFocus)}">
        </inek:BooleanRadioButton>
    </div>

    <h:panelGroup rendered="#{editCalcBasicsDrg.calcBasics.centralFocus}">
        <h:dataTable  headerClass="list-header" id="centre"
                      value="#{editCalcBasicsDrg.calcBasics.centralFocuses}" var="item" width="100%" rowClasses="row1, row2" 
                      columnClasses="colIcon, col03, col03, col03, col03, col03, col03, col03"
                      rendered="true"
                      >

            <h:column>
                <f:facet name="header">
                    <h:outputText value=""/>
                </f:facet>
                <h:commandLink styleClass="colIcon">
                    <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}"
                                    rendered="#{!editCalcBasicsDrg.readOnly}"
                                    value=""/>
                    <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteCentralFocus(item)}" />
                </h:commandLink>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Zentrums- bzw. Schwerpunktbezeichnung"/><br/>
                    <h:outputText value="(aussagekräftiger Name)"/>
                </f:facet>
                <h:inputText value="#{item.text}" styleClass="inputwide"
                             readonly="#{editCalcBasicsDrg.readOnly}"
                             required="true">
                    <f:ajax event="blur" render="@this :logout:remaining"/>
                </h:inputText>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Fallzahl"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.caseCnt}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Personalkosten"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.personalCost}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Sachkosten"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.materialcost}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Infrastrukturkosten"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.infraCost}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Vereinbartes Entgelt je Fall"/>
                </f:facet>
                <inek:InputIntegerWithMessage value="#{item.remunerationAmount}" styleClass="inputwide" required="true"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              renderElement="@this :logout:remaining"/>
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="Entgeltschlüssel"/>
                </f:facet>
                <h:inputText value="#{item.remunerationKey}" styleClass="inputwide"
                             readonly="#{editCalcBasicsDrg.readOnly}"
                             required="true">
                    <f:ajax event="blur" render="@this :logout:remaining"/>
                </h:inputText>
            </h:column>

        </h:dataTable>

        <h:commandLink id="addButtonCentre" styleClass="addButton inputPart"
                       rendered="#{!editCalcBasicsDrg.readOnly}"
                       value="#{msg.btnAddEntry}">
            <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addCentralFocus()}"/>
        </h:commandLink>
    </h:panelGroup>

    <h2>Berücksichtigte Abgrenzungstatbestände</h2>

    <ui:repeat value="#{editCalcBasicsDrg.calcBasics.delimitationFacts}" var="x" varStatus="status">

        <div class="inputPart">
            <h:outputLabel value="#{x.contentText.text}" styleClass="#{x.requireInputs ? 'blockElement' : 'blockElementLight'}" style="width: calc(100% - 22em);"/> &nbsp;
            <h:selectBooleanCheckbox styleClass="blockElement" style="width: 2em;"
                                     disabled="#{editCalcBasicsDrg.readOnly}"
                                     value="#{x.used}">
                <f:ajax event="change" render="@form :logout:remaining delimit-content :script" 
                        listener="#{sessionController.hideData(x.used or !x.requireInputs)}"/>
            </h:selectBooleanCheckbox>
            <h:outputLabel value="#{editCalcBasicsDrg.calcBasics.dataYear}" styleClass="blockElement" style="width: 6em;" rendered="#{x.used and x.requireInputs}"/>
            <h:outputLabel value="#{editCalcBasicsDrg.calcBasics.dataYear - 1}" styleClass="blockElement" style="width: 6em;" rendered="#{x.used and x.requireInputs}"/>
            <h:outputLabel value="#{msg.lblDevitation}" styleClass="blockElement" style="width: 6em;" rendered="#{x.used and x.requireInputs}"/>
        </div>

        <h:dataTable value="#{x.contentText.text eq 'Investitionskosten' ? calcBasicsStaticData.invDelimitationFactsSubTitles : calcBasicsStaticData.delimitationFactsSubTitles}" 
                     rendered="#{x.used and x.requireInputs}"
                     var="data" 
                     width="100%"
                     rowClasses="row1, row2"
                     columnClasses="colValue, col05em number, col05em number, col05em number"
                     styleClass="marginTop">

            <h:column>
                <h:outputLabel rendered="#{x.requireInputs}" value="#{data}"/>
            </h:column>

            <h:column rendered="#{x.used and x.requireInputs}">
                <inek:InputIntegerWithMessage id="data-personal" rendered="#{data eq 'Personalkosten'}"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              value="#{x.personalCost}"
                                              styleClass="col06em" required="true" renderElement="@this diff-personal :logout:remaining"
                                              disabled="#{x.contentText.text eq 'Investitionskosten'}"/>
                <inek:InputIntegerWithMessage id="data-material"
                                              rendered="#{data eq 'Sachkosten' or data eq 'Kostenvolumen'}"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              value="#{x.materialCost}"
                                              styleClass="col06em" required="true" renderElement="@this diff-material :logout:remaining"
                                             />
                <inek:InputIntegerWithMessage id="data-infra" rendered="#{data eq 'Infrastrukturkosten'}"
                                              readonly="#{editCalcBasicsDrg.readOnly}"
                                              value="#{x.infraCost}"
                                              styleClass="col06em" required="true" renderElement="@this diff-infra :logout:remaining"
                                              disabled="#{x.contentText.text eq 'Investitionskosten'}"/>
            </h:column>

            <h:column rendered="#{x.used and x.requireInputs}">
                <inek:InputIntegerWithMessage rendered="#{data eq 'Personalkosten'}" value="#{editCalcBasicsDrg.getPriorDelimitationFact(x.contentTextId).personalCost}" styleClass="col06em" disabled="true"/>
                <inek:InputIntegerWithMessage rendered="#{data eq 'Sachkosten' or data eq 'Kostenvolumen'}" value="#{editCalcBasicsDrg.getPriorDelimitationFact(x.contentTextId).materialCost}" styleClass="col06em" disabled="true"/>
                <inek:InputIntegerWithMessage rendered="#{data eq 'Infrastrukturkosten'}" value="#{editCalcBasicsDrg.getPriorDelimitationFact(x.contentTextId).infraCost}" styleClass="col06em" disabled="true"/>
            </h:column>

            <h:column rendered="#{x.used and x.requireInputs}">
                <h:panelGrid id="diff-personal" style="margin: 0; padding : 0;">
                    <inek:InputIntegerWithMessage rendered="#{data eq 'Personalkosten'}"
                                                  readonly="#{editCalcBasicsDrg.readOnly}"
                                                  value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.getPriorDelimitationFact(x.contentTextId).personalCost, x.personalCost)}"
                                                  styleClass="col06em"
                                                  disabled="true"/>
                </h:panelGrid>
                <h:panelGrid id="diff-material" style="margin: 0; padding : 0;">
                    <inek:InputIntegerWithMessage rendered="#{data eq 'Sachkosten' or data eq 'Kostenvolumen'}"
                                                  readonly="#{editCalcBasicsDrg.readOnly}"
                                                  value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.getPriorDelimitationFact(x.contentTextId).materialCost, x.materialCost)}"
                                                  styleClass="col06em"
                                                  disabled="true"/>
                </h:panelGrid>
                <h:panelGrid id="diff-infra" style="margin: 0; padding : 0;">
                    <inek:InputIntegerWithMessage rendered="#{data eq 'Infrastrukturkosten'}"
                                                  readonly="#{editCalcBasicsDrg.readOnly}"
                                                  value="#{editCalcBasicsDrg.calcPercentualDiff(editCalcBasicsDrg.getPriorDelimitationFact(x.contentTextId).infraCost, x.infraCost)}"
                                                  styleClass="col06em"
                                                  disabled="true"/>
                </h:panelGrid>
            </h:column>
        </h:dataTable>
    </ui:repeat>

</ui:composition>

