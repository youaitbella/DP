<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:cc="http://xmlns.jcp.org/jsf/composite"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:cb="http://inek.org/dataportal/clientbehaviour"
      xmlns:inek="http://xmlns.jcp.org/jsf/composite/components/common"

      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf">

    <!-- INTERFACE -->
    <cc:interface>
        <cc:attribute name="patType" default="Adults"/>
        <cc:attribute name="readonly" default="false"/>
    </cc:interface>

    <!-- IMPLEMENTATION -->
    <cc:implementation >
        <h2>Vereinbarte Stellenbesetzung in Vollkräften - Bereich #{'Adults'.equals(cc.attrs.patType) ? 'Erwachsene' : 'Kinder und Jugendliche'}</h2>
        <span>(§ 3 Psych-Personalnachweis)</span>
        <br/>
        <b>#{cc.id}</b>
        <br/>
        <b>#{cc.attrs.clientId}</b>

        <table jsf:id="data" class="marginTop">
            <thead>
                <tr>
                    <th class="col10em row1" scope="col"> Personalgruppen </th>
                    <th class="col10em row1" scope="col"> Berufsgruppen der Psych-PV </th>
                    <th class="col08em row1" scope="col"> Stellenbesetzung für eine voll-ständige Umsetzung der Psych-PV in VK </th>
                    <th class="col08em row1" scope="col"> Stellenbesetzung als Budgetgrund-lage in VK </th>
                    <th class="col08em row1" scope="col"> Durchschnitts-kosten je VK in Euro </th>
                </tr>
            </thead>
            <tbody>
                <ui:repeat value="#{editPsyStaff.staffProof.getStaffProofsAgreed(cc.attrs.patType)}" var="item">
                    <tr>
                        <td class="row1">
                            <h:outputText value="#{item.occupationalCatagory.personnelGroup.name}" styleClass="element10em"/>
                        </td>
                        <td class="row1"> 
                            <h:outputText value="#{item.occupationalCatagory.name}" styleClass="element10em"/>
                        </td>
                        <td>
                            <inek:InputNumberWithMessage value="#{item.staffingComplete}" 
                                                         styleClass="element08em number"
                                                         renderElement=":psychStaff:checksum :#{cc.attrs.clientId}:sumStaffingComplete @this"
                                                         pattern="#,##0.0"
                                                         isInt="false"/>
                        </td>
                        <td>
                            <inek:InputNumberWithMessage value="#{item.staffingBudget}" 
                                                         styleClass="element08em number"
                                                         renderElement=":psychStaff:checksum :#{cc.attrs.clientId}:sumStaffingBudget @this"
                                                         pattern="#,##0.0"
                                                         isInt="false"/>
                        </td>
                        <td >
                            <inek:InputNumberWithMessage value="#{item.avgCost}" 
                                                         styleClass="element08em number"
                                                         pattern="#,##0.00"
                                                         isInt="false"/>
                        </td>
                    </tr>
                </ui:repeat>
                <tfoot>
                    <tr>
                        <td class="col10em row1" scope="col"> </td>
                        <td class="col10em row1" scope="col"> Gesamt </td>
                        <th class="col08em row1" scope="col"> 
                            <h:inputText id="sumStaffingComplete" 
                                         value="#{editPsyStaff.sumAgreedStaffingComplete(cc.attrs.patType)}"
                                         styleClass="col08em number"
                                         disabled="true"/>
                        </th>
                        <td class="col08em row1" scope="col"> 
                            <h:inputText id="sumStaffingBudget" 
                                         value="#{editPsyStaff.sumAgreedStaffingBudget(cc.attrs.patType)}"
                                         styleClass="col08em number"
                                         disabled="true"/> 
                        </td>
                        <td class="col08em row1" scope="col">  </td>
                    </tr>

                </tfoot>
            </tbody>
        </table>

        <inek:LabeledText id="agreedDays"
                          label="#{msg.lblAgreedDays} (#{editPsyStaff.staffProof.calculationType == '1' ? 'PEPPV' : 'BPflV/LKA'})"
                          value="#{'Adults'.equals(cc.attrs.patType) ? editPsyStaff.staffProof.adultsAgreedDays : editPsyStaff.staffProof.kidsAgreedDays}"
                          styleClass="inputSmall"
                          renderElement="checksum"/>
        </h:panelGroup>


        <div class="uploadFile inlineBlock">
            <h:inputFile style="width: 185px;" styleClass="hiddenFile" id="file" value="#{editPsyStaff.file}">
                <f:ajax listener="#{editPsyStaff.uploadFile(cc.attrs.patType, 1)}" render="@all"/>
            </h:inputFile>
            <div class="fakeFile">
                <h:outputLabel style="margin-top: 0px;" styleClass="button element100" value="Unterschriebene Vereinbarung hochladen"/>
            </div>

        </div>


    </cc:implementation>
</html>
