<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:cb="http://inek.org/dataportal/clientbehaviour"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components"
                xmlns:jsf="http://xmlns.jcp.org/jsf">

    <h2>#{msg.TopicCalcEndoscopy}</h2>

    <inek:LabeledCheckbox label="#{msg.lblHasEndoscopy}" 
                          styleClassLabel="label40"
                          value="#{editCalcBasicsDrg.calcBasics.endoscopy}"
                          renderElement="@form"/>

    <div jsf:id="cardiology" jsf:rendered="#{editCalcBasicsDrg.calcBasics.endoscopy}">
        <inek:LabeledText label="#{msg.lblEndoscopyRoomCount}" 
                          styleClassLabel="label40"
                          value="#{editCalcBasicsDrg.calcBasics.endoscopyRoomCnt}" 
                          singleLine="true" 
                          styleClass="inputSmall"/>

        <inek:LabeledText label="#{msg.lblEndoscopyCaseCount}" 
                          styleClassLabel="label40"
                          value="#{editCalcBasicsDrg.calcBasics.endoscopyCaseCnt}" 
                          singleLine="true" 
                          styleClass="inputSmall"/>
    </div>

    <h4><h:outputLabel value="Bitte geben Sie an für welche endoskopischen Bereiche Sie nicht den Leistungsschlüssel Eingriffszeit verwenden"/></h4>
    <h:dataTable value="#{editCalcBasicsDrg.endoscopyDifferentials}" 
                 var="data" 
                 width="100%" rowClasses="row1, row2" 
                 columnClasses="colIcon, volValue, col04em, col04em, volValue">

        <h:column>
            <h:commandLink action="#{editCalcBasicsDrg.deleteEndoscopyDifferential(data)}" 
                           rendered="true"
                           immediate="true" styleClass="colIcon">
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                <cb:confirmDelete/>
            </h:commandLink>
        </h:column>

        <h:column>
            <f:facet name="header">Endoskopischer Bereich</f:facet>
            <inek:InputTextWithMessage id="endoscopyDivision" required="true" value="#{data.division}" readonly="false" styleClass="fullWidth">
                <!--<f:validator validatorId="EmailValidator" for="contactMail"/>-->
            </inek:InputTextWithMessage>
        </h:column>

        <h:column>
            <f:facet name="header">Leistungsschlüssel</f:facet>
            <inek:InputTextWithMessage id="endoscopyKey" required="true" value="#{data.activityKey}" readonly="false" styleClass="fullWidth">
                <!--<f:validator validatorId="EmailValidator" for="contactMail"/>-->
            </inek:InputTextWithMessage>
        </h:column>
    </h:dataTable>
    
    <h:commandLink id="addButton" styleClass="addButton inputPart" value="#{msg.btnAddEntry}" rendered="true">
        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addEndoscopyDifferentials()}"/>
    </h:commandLink>
    
    <style>
        #endoAmbu td {
            vertical-align: top;
        }
    </style>
    
    <table id="endoAmbu" class="marginTop">
        <tr>
            <th></th>
            <th>
                Ambulante Leistungen im endoskopischen Bereich
            </th>
            <th>
                Leistungsschlüssel
            </th>
            <th>
                Anzahl erbrachter amb. Leistungen
            </th>
            <th>
                abgegr. Kostenvolumen ÄD
            </th>
            <th>
                abgegr. Kostenvolumen FD
            </th>
            <th>
                abgegr. Kostenvolumen med. Infrastruktur
            </th>
            <th>
                abgegr. Kostenvolumen nicht med.Infrastruktur
            </th>
        </tr>
        <ui:repeat value="#{editCalcBasicsDrg.calcBasics.endoscopyAmbulant}" var="item">
            <tr>
                <td>
                    <h:commandLink action="#{editCalcBasicsDrg.deleteEndoscopyAmbulant(item)}" 
                           rendered="true"
                           immediate="true" styleClass="colIcon">
                        <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                        <cb:confirmDelete/>
                    </h:commandLink>
                </td>
                <td>
            <inek:InputTextWithMessage value="#{item.ambulantService}" />
                </td>
                <td>
                <h:selectOneMenu value="#{item.serviceKey}" styleClass="inputwide">
                    <f:selectItems value="#{editCalcBasicsDrg.endoscopyAmbulantTypes}" />
                    <f:ajax event="change" render="@form :logout:remaining" />
                </h:selectOneMenu>
                <h:inputTextarea rendered="#{item.serviceKey == 4}" required="true" styleClass="inputwide" value="#{item.miscText}">
                    <f:ajax event="blur" render="@this :logout:remaining" />
                </h:inputTextarea>
                </td>
                <td>
                <inek:InputNumberWithMessage value="#{item.numServices}" />
                </td>
                <td>
                <inek:InputNumberWithMessage value="#{item.costVolumeMedical}" />
                </td>
                <td>
                <inek:InputNumberWithMessage value="#{item.costVolumeFunction}" />
                </td>
                <td>
                <inek:InputNumberWithMessage value="#{item.costVolumeMedInfra}" />
                </td>
                <td>
                <inek:InputNumberWithMessage value="#{item.costVolumeNonMedInfra}" />
                </td>
            </tr>
        </ui:repeat>
    </table>
    
    <h:commandLink id="addButton2" styleClass="addButton inputPart" value="#{msg.btnAddEntry}" rendered="true">
        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addEndoscopyAmbulant()}"/>
    </h:commandLink>
    
</ui:composition>

