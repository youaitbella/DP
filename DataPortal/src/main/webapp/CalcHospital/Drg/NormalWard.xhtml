<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:cb="http://inek.org/dataportal/clientbehaviour"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components"
                xmlns:jsf="http://xmlns.jcp.org/jsf">
    
    <h2>Ergänzende Angaben zur Normalstation</h2>
    
    <inek:LabeledCheckbox label="Das Krankenhaus hat Ärzte in freier Mitarbeit beschäftigt" value="#{editCalcBasicsDrg.calcBasics.normalFreelancing}" renderElement="@form :logout:remaining" />
    
    <h:dataTable  headerClass="list-header" id="centre"
                  value="#{editCalcBasicsDrg.calcBasics.normalFreelancers}" var="item" width="100%" rowClasses="row1, row2" 
                  columnClasses=",,,,centered, centered"
                  rendered="#{editCalcBasicsDrg.calcBasics.normalFreelancing}"
                  >

        <h:column>
            <f:facet name="header">
                
            </f:facet>
            <h:commandLink styleClass="colIcon">
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteFreelancer(item)}"/>
            </h:commandLink>
        </h:column>

        <h:column>
            <f:facet name="header">
                Bereich
            </f:facet>
            <h:inputText value="#{item.division}" styleClass="inputwide" required="true">
                <f:ajax render="@this :logout:remaining"/>
            </h:inputText>
        </h:column>

        <h:column>
            <f:facet name="header">
                Anzahl Vollkräfte
            </f:facet>
            <inek:InputNumberWithMessage value="#{item.fullVigorCnt}" styleClass="inputwide" required="true" renderElement="@this :logout:remaining" isInt="false"/>
        </h:column>

        <h:column>
            <f:facet name="header">
                Kostenvolumen (€)
            </f:facet>
            <inek:InputNumberWithMessage value="#{item.amount}" styleClass="inputwide" required="true" renderElement="@this :logout:remaining"/>
        </h:column>

        <h:column class="centered">
            <f:facet name="header">
                KoArtGr 1
            </f:facet>
            <h:selectBooleanCheckbox style="text-align: center;" value="#{item.costType1}" required="true">
                <f:ajax render="@this :logout:remaining"/>
            </h:selectBooleanCheckbox>
        </h:column>

        <h:column class="centered">
            <f:facet name="header">
                KoArtGr 6c
            </f:facet>
            <h:selectBooleanCheckbox value="#{item.costType6c}" required="true">
                <f:ajax render="@this :logout:remaining"/>
            </h:selectBooleanCheckbox>
        </h:column>

    </h:dataTable>

    <h:commandLink rendered="#{editCalcBasicsDrg.calcBasics.normalFreelancing}" id="addButton" styleClass="addButton inputPart" value="#{msg.btnAddEntry}">
        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addFreelancer()}"/>
    </h:commandLink>
    
    <h2>Honorarverträge gemäß § 121 Abs. 5 SGB V mit Belegärzten</h2>
    
    <inek:LabeledCheckbox label="Honorarverträge gemäß § 121 Abs. 5 SGB V mit Belegärzten" value="#{editCalcBasicsDrg.calcBasics.feeContract}" renderElement="@form :logout:remaining" />
    
     <h:dataTable  headerClass="list-header" id="feeContract"
                   value="#{editCalcBasicsDrg.calcBasics.normalFeeContracts}" var="item" width="100%" rowClasses="row1, row2" 
                  columnClasses=""
                  rendered="#{editCalcBasicsDrg.calcBasics.feeContract}"
                  >
         <h:column>
            <f:facet name="header">
                
            </f:facet>
            <h:commandLink styleClass="colIcon">
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteFeeContract(item)}"/>
            </h:commandLink>
        </h:column>

        <h:column>
            <f:facet name="header">
                Bereich
            </f:facet>
            <h:inputText value="#{item.division}" styleClass="inputwide" required="true">
                <f:ajax render="@this :logout:remaining"/>
            </h:inputText>
        </h:column>

        <h:column>
            <f:facet name="header">
                FAB-Schlüssel gemäß § 301 SGB V (4-stellig) 
            </f:facet>
            <h:inputText value="#{item.departmentKey}" styleClass="inputwide" required="true">
                <f:ajax render="@this :logout:remaining"/>
            </h:inputText>
        </h:column>

        <h:column>
            <f:facet name="header">
                Anzahl Fälle
            </f:facet>
            <inek:InputNumberWithMessage value="#{item.caseCnt}" styleClass="inputwide" required="true" renderElement="@this :logout:remaining"/>
        </h:column>
         
         <h:column>
            <f:facet name="header">
                abgegrenztes Kostenvolumen (€)
            </f:facet>
             <inek:InputNumberWithMessage value="#{item.amount}" styleClass="inputwide" required="true" renderElement="@this :logout:remaining"/>
        </h:column>


     </h:dataTable>
    
    <h:commandLink rendered="#{editCalcBasicsDrg.calcBasics.feeContract}" id="addButton2" styleClass="addButton inputPart" value="#{msg.btnAddEntry}">
        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addFeeContract()}"/>
    </h:commandLink>
    
    <h2>Leistungsdokumentation für die Kostenartengruppen 2, 4a und 6a</h2>
    
    <h:dataTable  headerClass="list-header" id="service"
                  value="#{editCalcBasicsDrg.calcBasics.normalStationServiceDocumentations}" var="item" width="100%" rowClasses="row1, row2" 
                  columnClasses=""
                  >
    
        <h:column>
            <f:facet name="header">
                
            </f:facet>
            <h:commandLink styleClass="colIcon">
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                <f:ajax event="click" render="@form :logout:remaining"/>
            </h:commandLink>
        </h:column>
    
        <h:column>
            <f:facet name="header">
                Dokumentation
            </f:facet>
            <inek:BooleanRadioButton value="#{item.used}" label="#{item.label}" renderElement="@form :logout:remaining" />
        </h:column>
        
        <h:column>
            <f:facet name="header">
                Fachabteilung
            </f:facet>
            <h:inputText styleClass="inputwide" value="#{item.department}" disabled="#{item.used}" required="#{!item.used}">
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>
        
        <h:column>
            <f:facet name="header">
                FAB-Schlüssel gemäß § 301 SGB V (4-stellig) 
            </f:facet>
            <h:inputText styleClass="inputwide" value="#{item.departmentKey}" disabled="#{item.used}" required="#{!item.used}">
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>
        
        <h:column>
            <f:facet name="header">
                Alternativverfahren
            </f:facet>
            <h:inputText styleClass="inputwide" value="#{item.alternative}" disabled="#{item.used}" required="#{!item.used}">
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>
    
    </h:dataTable>
    
    <h2>Hochaufwendige Pflegeleistungen</h2>
    <table>
        <tr>
            <th>Die Erfassung des PKMS liegt in allen relevanten Normalstationen vor</th>
        </tr>
        <tr>
            <td>
        <h:selectOneMenu value="#{editCalcBasicsDrg.calcBasics.pkmsRecording}">
            <f:selectItem itemValue="0" itemLabel="Nein" />
            <f:selectItem itemValue="1" itemLabel="Ja" />
            <f:selectItem itemValue="2" itemLabel="KIS-integriert" />
            <f:selectItem itemValue="3" itemLabel="Manuell" />
            <f:selectItem itemValue="4" itemLabel="Sonstiges" />
            <f:ajax event="change" render="@form :logout:remaining" />
        </h:selectOneMenu>
            </td>
        </tr>
    </table>
    
    <h:dataTable  headerClass="list-header" id="pkmsAlt"
                  value="#{editCalcBasicsDrg.calcBasics.pkmsAlternatives}" var="item" width="100%" rowClasses="row1, row2" 
                  columnClasses=""
                  rendered="#{editCalcBasicsDrg.calcBasics.pkmsRecording == 0}"
                  >
        <h:column>
            <f:facet name="header">
                
            </f:facet>
            <h:commandLink styleClass="colIcon">
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deletePkmsService(item)}"/>
            </h:commandLink>
        </h:column>
        
        <h:column>
            <f:facet name="header">
                Fachabteilung
            </f:facet>
            <h:inputText styleClass="inputwide" value="#{item.department}">
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>
        
        <h:column>
            <f:facet name="header">
                FAB-Schlüssel gemäß § 301 SGB V (4-stellig) 
            </f:facet>
            <h:inputText styleClass="inputwide" value="#{item.departmentKey}">
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>
        
        <h:column>
            <f:facet name="header">
                Alternativverfahren
            </f:facet>
            <h:inputText styleClass="inputwide" value="#{item.alternative}">
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>
    </h:dataTable>
    
    <h:commandLink id="addButton3" rendered="#{editCalcBasicsDrg.calcBasics.pkmsRecording == 0}" styleClass="addButton inputPart" value="#{msg.btnAddEntry}">
        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addPkmsService()}"/>
    </h:commandLink>
    
    <style>
        #tbl {
            margin-top: 20px;
        }
        #tbl tr:first-child td {
            text-align: center;
            font-size: 1.2em;
        }
        #tbl td {
            background-color: #7F9BAF;
            font-weight: bold;
            color: white;
            padding: 2px 6px 2px 6px;
        }
        
        #tbl input {
            width: 100px;
        }
        
        .red {
            color: red;
        }
    </style>
    
    <div style="overflow-x: scroll;">
        <table id="tbl">
            <tr>
                <td></td>
                <td class="" colspan="9">Kosten in der Kostenstellengruppe 1 (Normalstation)</td>
                <td colspan="3">Anzahl der zugeordneten VK</td>
                <td colspan="7">Kosten der Kostenstelle</td>
            </tr>
            <tr>
                <td></td>
                <td class="">
                    Nummer der Kostenstelle
                </td>
                <td class="">
                    Name der Kostenstelle
                </td>
                <td class="">
                    FAB-Schlüssel gemäß § 301 SGB V (4-stellig) 
                </td>
                <td class="">
                    Belegung: FAB
                </td>
                <td class="">
                    Bettenzahl
                </td>
                <td class="">
                    Pflegetage
                </td>
                <td class="">
                    PPR-Minuten
                </td>
                <td class="">
                    zusätzliche Gewichtung außer PPR
                </td>
                <td class="">
                    Auslastung
                </td>
                <td>
                    Ärztlicher Dienst
                </td>
                <td>
                    Pflegedienst
                </td>
                <td>
                    Funktionsdienst
                </td>
                <td>
                    Ärztlicher Dienst
                </td>
                <td>
                    Pflegedienst
                </td>
                <td>
                    Funktionsdienst
                </td>
                <td>
                    Gemeinkosten Arzneimittel
                </td>
                <td>
                    Gemeinkosten med. Sachbedarf
                </td>
                <td>
                    medizinische Infrastruktur
                </td>
                <td>
                    nicht med. Infrastruktur
                </td>
            </tr>
            <c:forEach items="#{editCalcBasicsDrg.calcBasics.costCenterCosts}" var="x">
                <tr>
                    <td>
                        <h:commandLink styleClass="colIcon">
                            <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                            <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteCostCenterCosts(x)}"/>
                        </h:commandLink>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.costCenterNumber}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <h:inputText value="#{x.costCenterText}" >
                        <f:ajax event="blur" render="@this :logout:remaining" />
                    </h:inputText>
                    </td>
                    <td>
                    <h:inputText value="#{x.departmentKey}" >
                        <f:ajax event="blur" render="@this :logout:remaining" />
                    </h:inputText>
                    </td>
                    <td>
                    <h:inputText value="#{x.departmentAssignment}" >
                        <f:ajax event="blur" render="@this :logout:remaining" />
                    </h:inputText>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.bedCnt}"  renderElement="@this calc-field :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.careDays}"  renderElement="@this calc-field :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.pprMinutes}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.pprWeight}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage title="#{(x.careDays != 0 and x.bedCnt != 0 and (x.careDays / (x.bedCnt * 365)) lt 0.6) ? 'Der Wert ist unter 60%!' : ''}" 
                                                styleClass="#{(x.careDays != 0 and x.bedCnt != 0 and (x.careDays / (x.bedCnt * 365)) lt 0.6) ? 'red' : ''}"
                                                 id="calc-field" disabled="true" 
                                                 value="#{(x.careDays != 0 and x.bedCnt != 0) ? (x.careDays / (x.bedCnt * 365)) : ''}" 
                                                 renderElement="@this :logout:remaining" isInt="false"
                                                 pattern="0.00"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.medicalServiceCnt}"  renderElement="@this :logout:remaining" isInt="false"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.nursingServiceCnt}"  renderElement="@this :logout:remaining" isInt="false"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.functionalServiceCnt}"  renderElement="@this :logout:remaining" isInt="false"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.medicalServiceAmount}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.nursingServiceAmount}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.functionalServiceAmount}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.overheadsMedicine}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.overheadsMedicalGoods}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.medicalInfrastructureCost}"  renderElement="@this :logout:remaining"/>
                    </td>
                    <td>
                    <inek:InputNumberWithMessage value="#{x.nonMedicalInfrastructureCost}"  renderElement="@this :logout:remaining"/>
                    </td>
                </tr>
            </c:forEach>
            <tr>
                <td colspan="20">
                    <h:commandLink id="addButton4" styleClass="addButton inputPart" value="#{msg.btnAddEntry}">
                        <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.addCostCenterCosts()}"/>
                    </h:commandLink>
                </td>
            </tr>
        </table>
    </div>
    
</ui:composition>

