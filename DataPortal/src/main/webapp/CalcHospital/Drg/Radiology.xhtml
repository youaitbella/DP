<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>

<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:cb="http://inek.org/dataportal/clientbehaviour"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components"
                xmlns:jsf="http://xmlns.jcp.org/jsf">

    <style>
        td {
            vertical-align: top !important;
        }
        .col1 {
            max-width: 60px;
        }
        .col2 {
            max-width: 220px;
            width: 200px;
        }
        .col3 {
            max-width: 120px;
        }
        .col4 {
            max-width: 180px;
            width: 160px;
        }
        .col5 {
            max-width: 120px;
        }

        input[type=checkbox] {
            float: right;
            margin-right: 30px;
        }
    </style>

    <h2>Kostenstellengruppe 9 (Radiologie)</h2>

    <h:dataTable value="#{editCalcBasicsDrg.radiologies}" 
                 var="item" 
                 width="100%"
                 rowClasses="row1, row2"
                 columnClasses="colIcon, col1, col2, col3, col4, col5"
                 styleClass="marginTop">

        <h:column>
            <f:facet name="header">
                <h:outputText value=""/>
            </f:facet>
            <h:commandLink>
                <h:graphicImage alt="#{msg.btnDelete}" name="Icon/small/delete.png" title="#{msg.btnDelete}" value=""/>
                <f:ajax event="click" render="@form :logout:remaining" listener="#{editCalcBasicsDrg.deleteLaboratory(item)}"/>
            </h:commandLink>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Nr. Kostenstelle"/>
            </f:facet>
            <h:inputText styleClass="inputshort" value="#{item.costCenterNumber}" >
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Name Kostenstelle"/><br/>
                <h:outputLabel value="(aussagekräftiger Name)"/>
            </f:facet>
            <h:inputText value="#{item.costCenterText}" >
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputText>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Leistungsdokumentation"/>
            </f:facet>

            <h:selectOneMenu value="#{item.service}">
                <f:selectItems value="#{calcBasicsStaticData.radLabServices}" />
                <f:ajax event="change" render="@form :logout:remaining" />
            </h:selectOneMenu>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Beschreibung"/>
            </f:facet>
            <h:inputTextarea rendered="#{item.service == 1 || item.service == 5}"  required="#{item.service == 1 || item.service == 5}" class="areaWideHigh" value="#{item.description}" >
                <f:ajax event="blur" render="@this :logout:remaining" />
            </h:inputTextarea>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Leistungsvolumen"/><br/>
                <h:outputLabel value="vor Abgrenzung"/><br/>
            </f:facet>
            <inek:InputNumberWithMessage renderElement="point-value:text" value="#{item.serviceVolumePre}" />
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Kostenvolumen"/><br/>
                <h:outputLabel value="vor Abgrenzung"/><br/>
            </f:facet>
            <inek:InputNumberWithMessage value="#{item.amountPre}" renderElement="point-value:text"/>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Leistungsvolumen"/><br/>
                <h:outputLabel value="nach Abgrenzung"/><br/>
            </f:facet>
            <inek:InputNumberWithMessage value="#{item.serviceVolumePost}" renderElement="point-value2:text"/>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Kostenvolumen"/><br/>
                <h:outputLabel value="nach Abgrenzung"/><br/>
            </f:facet>
            <inek:InputNumberWithMessage value="#{item.amountPost}" renderElement="point-value2:text"/>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Punktwert (Vor)"/><br/>
            </f:facet>
            <inek:InputNumberWithMessage id="point-value" value="#{(item.amountPre != 0 and item.serviceVolumePre != 0) ? item.amountPre / item.serviceVolumePre : 0}" readonly="true" pattern="0.0"/>
        </h:column>

        <h:column>
            <f:facet name="header">
                <h:outputLabel value="Punktwert (Nach)"/><br/>
            </f:facet>
            <inek:InputNumberWithMessage id="point-value2" value="#{(item.amountPost != 0 and item.serviceVolumePost != 0) ? item.amountPost / item.serviceVolumePost : 0}" readonly="true" pattern="0.0"/>
        </h:column>
    </h:dataTable>
    
    <inek:UploadButtons2 importer="#{editCalcBasicsDrg.getImporter('drgradiology')}"
                         calcbase="#{editCalcBasicsDrg.calcBasics}" 
                         readOnly="#{editCalcBasicsDrg.readOnly}"
                         addListener="#{editCalcBasicsDrg.addRadiology()}"
                         uploadButtonText="Upload"
                         actionDeleteTable="#{editCalcBasicsDrg.deleteRadiologies()}"
                         />

    <br/>

    <h2>Radiologie Leistungen</h2>

    <style>
        #radioServicesTable {
            overflow-x: scroll;
        }
        .underlined-col {
            border-bottom: solid 1px #043358;
        }
        .border-right-col {
            border-right: solid 1px #043358;
        }
    </style>

    <br/>

    <table id="radioServicesTable">
        <!--tr>
            <td class="underlined-col border-right-col" colspan="6"><b># {editCalcBasicsDrg.calcBasics.dataYear}</b></td>
            <td class="underlined-col border-right-col" colspan="4"><b># {editCalcBasicsDrg.calcBasics.dataYear-1}</b></td>
        </tr-->
        <tr>
            <th>Ausgewählte Leistung</th>
            <th>OPS</th>
            <th>Kosten pro Leistung</th>
            <th>Fallzahl stationär</th>
            <th>Fallzahl ambulant</th>
            <th class="border-right-col">abgegr. Kosten-volumen (€) ambulant</th>
            <!--th>Kosten pro Leistung</th>
            <th>Fallzahl stationär</th>
            <th>Fallzahl ambulant</th>
            <th class="border-right-col">abgegr. Kosten-volumen (€) ambulant</th-->
        </tr>
        <ui:repeat value="#{editCalcBasicsDrg.calcBasics.radiologyServices}" var="item">
            <tr>
                <td class="underlined-col">#{editCalcBasicsDrg.getContentText(item.rsContentTextID)}</td>
                <td class="underlined-col">#{item.opsCode}</td>
                <td>
            <inek:InputNumberWithMessage value="#{item.serviceCost}" />
            </td>
            <td>
            <inek:InputNumberWithMessage value="#{item.caseCntStationary}" />
            </td>
            <td>
            <inek:InputNumberWithMessage value="#{item.caseCntAmbulant}" />
            </td>
            <td>
            <inek:InputNumberWithMessage value="#{item.ambulantAmount}" />
            </td>
            <!--td>
            <inek:InputNumberWithMessage 
                disabled="true"
                value="# {editCalcBasicsDrg.getPriorRadiologyService(item.rsContentTextID).serviceCost}" />
            </td>
            <td>
            <inek:InputNumberWithMessage 
                disabled="true"
                value="# {editCalcBasicsDrg.getPriorRadiologyService(item.rsContentTextID).caseCntStationary}" />
            </td>
            <td>
            <inek:InputNumberWithMessage 
                disabled="true"
                value="# {editCalcBasicsDrg.getPriorRadiologyService(item.rsContentTextID).caseCntAmbulant}" />
            </td>
            <td>
            <inek:InputNumberWithMessage 
                disabled="true"
                value="# {editCalcBasicsDrg.getPriorRadiologyService(item.rsContentTextID).ambulantAmount}" />
            </td-->
            </tr>
        </ui:repeat>
    </table>

</ui:composition>

