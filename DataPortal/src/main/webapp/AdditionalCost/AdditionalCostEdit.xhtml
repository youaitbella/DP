<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/Templates/PortalMenuTemplate.xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:cb="http://inek.org/dataportal/clientbehaviour"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                >

    <ui:define name="content">
        <h:form id="addtionalCost" enctype="multipart/form-data" >       
            <h1><h:commandLink value="Neue Mehrkosten" 
                               action="#{sessionController.navigate(sessionTools.pages.AdditionalCostSummary)}" 
                               immediate="true"/></h1>

            <div class="edit">
                <inek:LabeledText rendered="#{not sessionController.isInekUser('ADDITIONAL_COST')}"
                                  readonly="true"
                                  singleLine="true"
                                  displayAsLabel="true"
                                  label="#{msg.lblContractKey}" 
                                  value="#{sessionController.isInekUser('ADDITIONAL_COST') or editAdditionalCost.additionalCost.code.length() gt 0
                                           ? editAdditionalCost.additionalCost.code 
                                           : msg.lblNotGrantedYet}" />
                <inek:LabeledText rendered="#{sessionController.isInekUser('ADDITIONAL_COST')}" 
                                  singleLine="true"
                                  displayAsLabel="true"
                                  label="#{msg.lblContractKey}" 
                                  value="#{editAdditionalCost.additionalCost.code}" />

                <inek:MultiIk id="ikMulti" value="#{editAdditionalCost.additionalCost.ik}" 
                              ikList="#{editAdditionalCost.iks}"
                              listener="#{editAdditionalCost.ikChanged}" 
                              renderElement="adcData"
                              isFixed="#{editAdditionalCost.additionalCost.id gt 0}"/>


                <div jsf:id="adcData" jsf:rendered="#{editAdditionalCost.additionalCost.ik gt 0}">

                    <ui:remove>
                        <!--Krankenhaus-->
                        <h2 style="margin-bottom: 1em;">Krankenhaus</h2>
                        <inek:LabeledText id="hospital" label="Name des Krankenhauses" value="#{editAdditionalCost.additionalCost.hospital}" 
                                          singleLine="true" styleClassLabel="label10" 
                                          styleClass="element50" required="true" readonly="#{editAdditionalCost.readOnly}"/>
                        <inek:LabeledText id="street" label="#{msg.lblStreet}" value="#{editAdditionalCost.additionalCost.street}" 
                                          singleLine="true" styleClassLabel="label10" styleClass="element50" required="true" 
                                          readonly="#{editAdditionalCost.readOnly}"/>
                        <inek:LabeledText id="zip" label="#{msg.lblPostalCode}" value="#{editAdditionalCost.additionalCost.zip}" 
                                          singleLine="true" styleClassLabel="label10" styleClass="element50" required="true" 
                                          readonly="#{editAdditionalCost.readOnly}"/>
                        <inek:LabeledText id="city" label="#{msg.lblTown}" value="#{editAdditionalCost.additionalCost.city}" 
                                          singleLine="true" styleClassLabel="label10" styleClass="element50" required="true" 
                                          readonly="#{editAdditionalCost.readOnly}"/>

                        <!--Ansprechpartner-->
                        <h2>#{msg.lblContactPerson}</h2>
                        <h:panelGroup styleClass="element100 marginTop01em">
                            <h:outputLabel styleClass="label10" for="cbxGender" 
                                           value="#{msg.lblSalutation}"/>
                            <h:selectOneMenu styleClass="inputshort" id="cbxGender" value="#{editAdditionalCost.additionalCost.gender}"
                                             required="true" requiredMessage="#{msg.msgChooseEntryShort}">
                                <f:selectItems value="#{sessionTools.genderItems}"/>
                                <f:ajax event="blur" render="@this msgGender"/>
                            </h:selectOneMenu>
                            <h:message id="msgGender" for="cbxGender" styleClass="errorMessage"/>
                        </h:panelGroup>

                        <inek:LabeledText id="firstName" label="#{msg.lblFirstName}" 
                                          value="#{editAdditionalCost.additionalCost.contactFirstName}"
                                          singleLine="true" styleClassLabel="label10" 
                                          styleClass="element50" required="true"/>

                        <inek:LabeledText id="lastName" label="#{msg.lblLastName}" 
                                          value="#{editAdditionalCost.additionalCost.contactLastName}" 
                                          singleLine="true" styleClassLabel="label10" 
                                          styleClass="element50" required="true"/>

                        <inek:LabeledText id="phone" label="#{msg.lblPhone}" 
                                          value="#{editAdditionalCost.additionalCost.contactPhone}" 
                                          singleLine="true" styleClassLabel="label10" 
                                          styleClass="element50" required="true"/>

                        <inek:LabeledText id="mail" label="#{msg.lblMail}" 
                                          value="#{editAdditionalCost.additionalCost.contactEmail}" 
                                          singleLine="true" styleClassLabel="label10" 
                                          styleClass="element50" required="true"/>
                    </ui:remove>


                    <!--Mehrkosten-->
                    <h2>Mehrkosten</h2>
                    <h:panelGroup styleClass="element100 marginTop01em">
                        <h:outputLabel for="cbxPerinatalcentre"
                                       value="#{msg.perinatalzentrum_level}"
                                       title="Perinatalzentrum Level"
                                       styleClass="label40"
                                       /> 
                        <h:selectOneMenu id="cbxPerinatalcentre"
                                         styleClass="element15" 
                                         required="true" 
                                         requiredMessage="#{msg.msgChooseEntryShort}"
                                         value="#{editAdditionalCost.additionalCost.perinatalcentreLevel}"
                                         title="Auswahlbox mit den Werten 1 und 2, nach erstmaliger Eingabe Bestandteil der Anmeldung"
                                         hideNoSelectionOption="true"
                                         >
                            <f:selectItems value="#{sessionTools.perinatalcentreItems}"/>
                            <f:ajax event="blur" render="@form msgPerinatalcentre"/>
                        </h:selectOneMenu>
                    </h:panelGroup>

                    <h:outputLabel for="periodFrom" 
                                   value="#{msg.period}" 
                                   title="Die folgende Vereinbarungsdaten beziehen sich auf den Vereinbarungszeitraum"
                                   styleClass="label40"
                                   />
                    <h:selectOneMenu id="periodFrom"
                                     styleClass="element15"
                                     required="true"
                                     requiredMessage="#{msg.msgValueNeeded}"
                                     value="#{editAdditionalCost.additionalCost.periodFrom}"
                                     hideNoSelectionOption="true"  
                                     >
                        <f:selectItems value="#{sessionTools.periodFromItems}"/>
                        <f:ajax event="change" render="@form :logout:remaining periodFrom"/>
                    </h:selectOneMenu>

                    <h:outputLabel for="periodTo" 
                                   value="bis " 
                                   title="periodTo"
                                   styleClass="label40" style="width: 200px;padding-left: 10px; padding-right: 10px; display: inline"/>
                    <h:selectOneMenu id="periodTo"
                                     styleClass="element15"
                                     required="true"
                                     requiredMessage="#{msg.msgValueNeeded}"
                                     value="#{editAdditionalCost.additionalCost.periodTo}"
                                     hideNoSelectionOption="true"  
                                     >
                        <f:selectItems value="#{sessionTools.periodToItems}"/>
                        <f:ajax event="change" />
                    </h:selectOneMenu>

                    <inek:LabeledText id="effectivCaseMix" 
                                      label="#{msg.effectivCaseMix}"
                                      title="Abgabe der Summe ggf. gilt eine aktualisierte DRG-Aufstellung"
                                      value="#{editAdditionalCost.additionalCost.effectivCaseMix}" singleLine="true" 
                                      styleClassLabel="label40" styleClass="element50" required="true" 
                                      />
                    <inek:LabeledText id="extraChargeA" label="#{msg.extraChargeA}" 
                                      value="#{editAdditionalCost.additionalCost.extraChargeA}" singleLine="true"
                                      title="Angabe des Zuschlagvolumens"
                                      styleClassLabel="label40" styleClass="element50" required="true"/>

                    <inek:LabeledText id="extraChargeB" label="#{msg.extraChargeB}" 
                                      value="#{editAdditionalCost.additionalCost.extraChargeB}" singleLine="true"
                                      title="Angabe des Zuschlagvolumens" 
                                      styleClassLabel="label40" styleClass="element50" required="true"/>

                    <inek:LabeledText id="extraChargeC" label="#{msg.extraChargeC}" 
                                      value="#{editAdditionalCost.additionalCost.extraChargeC}" singleLine="true" 
                                      title="Angabe des Zuschlagvolumens" 
                                      styleClassLabel="label40" styleClass="element50" required="true"/>

                    <inek:LabeledText id="agreedHospitalIndividualExtraCharge" 
                                      label="#{msg.agreedHospitalIndividualExtraCharge}"
                                      value="#{editAdditionalCost.additionalCost.agreedHospitalIndividualExtraCharge}" singleLine="true" 
                                      title="Angabe des vereinbarten Zuschlagsvolumens, das Grundlage für die Berechnung des Krankenhausindividuellen Prozentsatzes" 
                                      styleClassLabel="label40" styleClass="element50" required="true" />

                    <inek:LabeledText id="hospitalIndividualExtraCharge" 
                                      label="#{msg.hospitalIndividualExtraCharge}" 
                                      value="#{editAdditionalCost.additionalCost.hospitalIndividualExtraCharge}" singleLine="true"  
                                      title="Angabe des vereinbarten Prozentsatzes(Zahlbetragsrelevant)"
                                      styleClassLabel="label40" styleClass="element50" required="true"/>

                    <div class="inputPart">
                        <h:outputLabel value="#{msg.isAdditionalCostAgreementAgreed}"
                                       title="Auswahlbos(ja/nein) Hinweis: Hier ist 'ja' anzugeben, wenn sich das vereinbartes
                                       Zuschlagsvolumen nicht als Summe der Zuschlagsanteile gemäß der grundlegenden 
                                       Berechnungsformel in Anlage 1 lfd. Nr. 5(CM*EURO-Betrag) ergibt"
                                       styleClass="label40"/>
                        <inek:Checkbox value="#{editAdditionalCost.additionalCost.isAdditionalCostAgreementAgreed}" styleClass="element10"/>
                    </div>

                    <inek:LabeledText id="agreedRepaymentAdditionalCost" 
                                      label="#{msg.agreedRepaymentAdditionalCost}"
                                      value="#{editAdditionalCost.additionalCost.agreedRepaymentAdditionalCost}" singleLine="true"
                                      title="Angabe des vereinbarten Rückzahlungsvolumens gem. lfd. Nr.8, getrennt nach vereinbarungsjahren"
                                      styleClassLabel="label40" styleClass="element50" required="true" />  

                    <h:outputLabel for="repaymentPeriodFrom" 
                                   value="#{msg.repaymentPeriodFrom}" 
                                   title="Angabe des Vereinbarungszeitraums für das angegebene Rückzahlungsvolumen vereinbart wurde."
                                   styleClass="label40"/>
                    <h:selectOneMenu id="repaymentPeriodFrom"
                                     styleClass="element15"
                                     required="true"
                                     requiredMessage="#{msg.msgValueNeeded}"
                                     value="#{editAdditionalCost.additionalCost.repaymentPeriodFrom}"
                                     hideNoSelectionOption="true"  
                                     >
                        <f:selectItems value="#{sessionTools.repaymentPeriodFromItems}"/>
                        <f:ajax event="change" render="@form :logout:remaining repaymentPeriodFrom"/>
                    </h:selectOneMenu>

                    <h:outputLabel for="repaymentPeriodTo" 
                                   value="bis" 
                                   title="RepaymentPeriodTo"
                                   styleClass="label40" style="width: 200px; padding-left: 10px; padding-right: 10px;  display: inline"/>
                    <h:selectOneMenu id="repaymentPeriodTo"
                                     styleClass="element12em"
                                     required="true"
                                     requiredMessage="#{msg.msgValueNeeded}"
                                     value="#{editAdditionalCost.additionalCost.repaymentPeriodTo}"
                                     hideNoSelectionOption="true"  
                                     >
                        <f:selectItems value="#{sessionTools.repaymentPeriodToItems}"/>
                        <f:ajax event="change" render="@form :logout:remaining repaymentPeriodTo"/>
                    </h:selectOneMenu>
                    
                    <h:panelGroup style="display: inline">                        
                        <inek:LabeledText id="complianceRate" label="#{msg.complianceRate}" 
                                          value="#{editAdditionalCost.additionalCost.complianceRate}" singleLine="true" 
                                          styleClassLabel="label40" styleClass="element140" required="true" />            
                        <h:outputLabel for="calenderYear" 
                                       value="für das Kalenderjahr" 
                                       title="Auswahlfenster füe die Jahre 2017, 2018,...,2020"
                                       styleClass="label40" />
                        <h:selectOneMenu id="calenderYear"
                                         styleClass="element12em"
                                         required="true"
                                         requiredMessage="#{msg.msgValueNeeded}"
                                         value="#{editAdditionalCost.additionalCost.calenderYear}"
                                         hideNoSelectionOption="true"  style="display: inline"
                                         >
                            <f:selectItems value="#{sessionTools.calenderYearItems}"/>
                            <f:ajax event="change" render="@form :logout:remaining calenderYear"/>
                        </h:selectOneMenu>
                    </h:panelGroup>
                        
                    <h:messages showDetail="true" globalOnly="true"/>
                </div>

                <!--Buttons-->
                <div class="toolBar">
                    <h:commandLink styleClass="bigButton"
                                   action="#{editAdditionalCost.save}"
                                   value="#{msg.btnSave}"
                                   immediate="true"
                                   rendered="#{!editAdditionalCost.readOnly or sessionController.isInekUser('ADDITIONAL_COST')}">
                    </h:commandLink>
                    <h:commandLink styleClass="sendButton"
                                   action="#{editAdditionalCost.seal}"
                                   value="#{msg.btnSaveAndClose}"
                                   rendered="#{editAdditionalCost.sealEnabled}"
                                   immediate="false"
                                   title="#{msg.infoSaveAndClose}">
                        <cb:confirmSeal/>
                    </h:commandLink>
                </div>
            </div>
        </h:form>
    </ui:define>
</ui:composition>
