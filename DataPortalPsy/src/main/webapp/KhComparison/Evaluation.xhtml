<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/Templates/PortalMenuTemplate.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:pf="http://primefaces.org/ui"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components/Other">

    <ui:define name="content">
        <h1>Krankenhausvergleich Auswertung</h1>
        <pf:panel style="background-color: #eeeeee;">

            <h:form>

                <inek:MultiIkYear labelIk="#{msg.lblIkShort}"
                                  required="true"
                                  valueIk="#{evaluation.selectedIk}"
                                  ikList="#{evaluation.allowedIks}"
                                  listenerIk="#{evaluation.ikChanged()}"
                                  labelYear="Vereinbarungsjahr"
                                  valueYear="#{evaluation.selectedAgreementYear}"
                                  yearList="#{evaluation.validYears}"
                                  showState="true"
                                  updateElement="@form" />

                <pf:commandButton value="Informative Auswertung starten"
                                  action="#{evaluation.startInfoEvaluation()}"
                                  rendered="#{evaluation.createNewEvaluationAllowed}"
                                  update="auswertungsTable"
                                  styleClass="btnPsy"
                                  immediate="true" />

                <pf:commandButton value="Auswertung starten"
                                  action="#{evaluation.startEvaluation()}"
                                  rendered="#{evaluation.createNewEvaluationAllowed}"
                                  update="auswertungsTable"
                                  styleClass="btnPsy"
                                  immediate="true" />

                <div class="ui-g ui-fluid">
                    <div class="ui-g-12">
                        <h2>Bereits erstellte Auswertungen</h2>
                        <pf:dataTable id="auswertungsTable"
                                      value="#{evaluation.listEvaluations}"
                                      var="ev"
                                      emptyMessage="Keine EintrÃ¤ge vorhanden"
                                      tableStyleClass="inekTablePsy">

                            <pf:column headerText="IK">
                                <pf:outputLabel value="#{ev.hospitalIk}" />
                            </pf:column>

                            <pf:column headerText="Vereinbarungsjahr">
                                <pf:outputLabel value="#{ev.agreementYear}" />
                            </pf:column>

                            <pf:column headerText="Auswertung vom">
                                <h:outputText value="#{ev.createdAt}">
                                    <f:convertDateTime pattern="dd.MM.yyyy" />
                                </h:outputText>
                            </pf:column>

                            <pf:column headerText="Krankenhausvergleich ID">
                                <pf:outputLabel value="#{ev.hospitalComparisonId}" />
                            </pf:column>

                            <pf:column>
                                <pf:button styleClass="btnPsy"
                                           value="Download" />
                            </pf:column>
                        </pf:dataTable>
                    </div>
                </div>


            </h:form>

        </pf:panel>

    </ui:define>

</ui:composition>
