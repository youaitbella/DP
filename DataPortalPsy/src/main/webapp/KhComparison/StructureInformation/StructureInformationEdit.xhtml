<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/Templates/PortalMenuTemplate.xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components/common"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:pf="http://primefaces.org/ui">


    <ui:define name="content">
        <pf:ajaxStatus style="display:block;position:absolute;bottom: 5px;right: 5px;z-index:100">
            <f:facet name="start">
                <pf:graphicImage height="100" width="100" name="Image/load.gif" />
            </f:facet>
            <f:facet name="complete">
                <h:outputText value="" />
            </f:facet>
        </pf:ajaxStatus>

        <pf:dialog header="Gültigkeitsdatum auswählen"
                   widgetVar="dialogValidFrom"
                   resizable="false"
                   dynamic="true"
                   modal="true">
            <h:form>
                <pf:outputLabel class="formLabel"
                                value="Neues Gültigkeitsdatum: "
                                for="validFromNew" />
                <pf:calendar id="validFromNew"
                             value="#{editStructureInformation.newValidFromDate}"
                             mindate="#{editStructureInformation.structureInformation.validFrom}"
                             validator="#{editStructureInformation.checkDate}"
                             locale="de"
                             navigator="true"
                             pattern="dd.MM.yyyy"
                             mask="true"
                             inputStyle="text-align: right;">
                    <pf:ajax event="dateSelect" update="validFromNewMessage" />
                    <pf:ajax event="change" update="validFromNewMessage" />
                </pf:calendar>
                <pf:message id="validFromNewMessage" for="validFromNew" />

                <pf:commandButton styleClass="btnPsy"
                                  value="Neue Gültigkeit speichern"
                                  actionListener="#{editStructureInformation.saveNewValidFrom()}"
                                  rendered="#{!editStructureInformation.isReadOnly()}"
                                  onsuccess="PF('dialogValidFrom').hide();"/>
            </h:form>
        </pf:dialog>

        <h:form>
            <h1>
                <h:commandLink value="Strukturinformationen" action="#{sessionController.navigate(sessionTools.pages.KhComparisonSummary)}" immediate="true"/>
            </h1>
        </h:form>
        <h:form style="background-color: #eeeeee">
            <div class="headerInformation">
                <ui:include src="StructureInformationGenerell.xhtml" />
            </div>

            <div>
                <ui:include src="StructureInformation.xhtml" />
            </div>

            <br />
            <pf:commandButton styleClass="btnPsy"
                              value="Speichern"
                              action="#{editStructureInformation.save()}"
                              update="@(.ui-message) @form"
                              rendered="#{!editStructureInformation.isReadOnly() and editStructureInformation.canSave()}"/>

            <pf:commandButton styleClass="btnPsy"
                              value="Neue Gültigkeit speichern"
                              update="@(.ui-message) @form"
                              onclick="PF('dialogValidFrom').show(); changeDialogColor('info');"
                              rendered="#{!editStructureInformation.isReadOnly()  and editStructureInformation.canSave()}"/>

            <br />
            <br />

        </h:form>
    </ui:define>

</ui:composition>
