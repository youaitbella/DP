<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html [<!ENTITY nbsp "&#160;">]>
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:jsf="http://xmlns.jcp.org/jsf"
                xmlns:inek="http://xmlns.jcp.org/jsf/composite/components/Input"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:pf="http://primefaces.org/ui">


    <pf:repeat value="#{editStructureInformation.validStructureCategoriesAreas}" var="structureInformationCategorie">

        <pf:fieldset legend="#{structureInformationCategorie.area}"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.collapsCategorie(structureInformationCategorie.area)}">

            <pf:repeat value="#{editStructureInformation.getStructureInformationsByArea(structureInformationCategorie.area)}" var="structureInformation">
                <div class="ui-g ui-fluid">
                    <div class="ui-g-2">
                        <pf:outputLabel class="formLabel"
                                        value="Gültig ab" />
                        <pf:calendar id="validFromNew"
                                     value="#{structureInformation.validFrom}"
                                     readonly="#{editStructureInformation.isReadOnly()}"
                                     locale="de"
                                     navigator="true"
                                     pattern="dd.MM.yyyy"
                                     mask="true"
                                     inputStyle="text-align: right;">
                            <pf:ajax event="change" update="validFromNewMessage" />
                            <pf:ajax event="dateSelect" update="validFromNewMessage" />
                        </pf:calendar>
                        <pf:message id="validFromNewMessage" for="validFromNew" />
                    </div>
                    <div class="ui-g-7">
                        <pf:outputLabel class="formLabel"
                                        value="#{structureInformation.structureCategorie.description}" />
                        <pf:inputTextarea rows="1"
                                          cols="50"
                                          value="#{structureInformation.content}"
                                          readonly="#{editStructureInformation.isReadOnly()}">
                            <pf:ajax />
                        </pf:inputTextarea>
                    </div>
                    <div class="ui-g-3">
                        <pf:commandButton styleClass="btnPsy"
                                          value="Neue Gültigkeit eintragen"
                                          actionListener="#{editStructureInformation.saveNewValidFrom(structureInformation)}"
                                          rendered="#{!editStructureInformation.isReadOnly() and editStructureInformation.showNewValityDate(structureInformation)}"
                                          update="@form"/>
                    </div>
                </div>

            </pf:repeat>

        </pf:fieldset>

    </pf:repeat>


    <ui:remove>

        <pf:fieldset legend="Allgemeine Angaben"
                     toggleable="true"
                     class="inekFieldset">
            <div class="ui-g ui-fluid">
                <div class="ui-g-4">
                    <inek:InputNumber value="#{editStructureInformation.structureInformation.bedCount}"
                                      labelText="Planbetten"
                                      readonly="#{editStructureInformation.isReadOnly()}"/>
                </div>
                <div class="ui-g-4">
                    <inek:InputNumber value="#{editStructureInformation.structureInformation.therapyPartCount}"
                                      labelText="Anzahl teilstationärer Therapieplätze"
                                      readonly="#{editStructureInformation.isReadOnly()}" />
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Regionale Versorgungsverpflichtung"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.regionalCare.length() eq 0}">

            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Stichpunktartige Beschreibung der strukturellen und personellen Besonderheiten duch die regionalen Versorgungsverpflichtung:" />
                    <pf:inputTextarea id="regionalCare"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.regionalCare}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Besonderheiten bei der gesetzlichen Unterbringung"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.accommodationText.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Beschreibung der strukturellen und personellen Besonderheiten für patienten mit gesetzlicher Unterbringung:" />
                    <pf:inputTextarea id="accommodationText"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.accommodationText}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Sozialpädiatrisches Zentrum gem. § 119 SGB V am Krankenhaus vorhanden"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.SPCenterText.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Leistungsangebot und Leistungsschwerpunkte:" />
                    <pf:inputTextarea id="SPCenterText"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.SPCenterText}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Ambulante Leistungserbringung des Krankenhauses"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.ambulantPerformanceMain.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Angabe der Leistungsschwerpunkte:" />
                    <pf:inputTextarea id="ambulantPerformanceMain"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.ambulantPerformanceMain}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Leistungen im Rahmen des Entlassmanagements"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.dismissManagement.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Leistungsschwerpunkte:" />
                    <pf:inputTextarea id="dismissManagement"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.dismissManagement}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Vorliegen und Struktur eines gemeindepsychiatrischen Verbunds"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.careProvider.length() eq 0 and editStructureInformation.structureInformation.performanceAreas.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-6">
                    <pf:outputLabel class="formLabel"
                                    value="Wesentliche eingebundene Leistungserbringer:" />
                    <pf:inputTextarea id="careProvider"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.careProvider}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>

                <div class="ui-g-6">
                    <pf:outputLabel class="formLabel"
                                    value="Zentrale Leistungsbereiche:" />
                    <pf:inputTextarea id="performanceAreas"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.performanceAreas}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Ambulante Infrastruktur im Umfeld des Krankenhauses"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.ambulantStructure.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Beschreibung der örtlichen Versorgungssituation im vertragsärztlichen/therapeutischen Bereich:" />
                    <pf:inputTextarea id="ambulantStructure"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.ambulantStructure}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

        <pf:fieldset legend="Umfang und Struktur der Sozialpsychiatrischen Dienste"
                     toggleable="true"
                     class="inekFieldset"
                     collapsed="#{editStructureInformation.structureInformation.socialPsychiatryService.length() eq 0}">
            <div class="ui-g ui-fluid">
                <div class="ui-g-12">
                    <pf:outputLabel class="formLabel"
                                    value="Beschreibung:" />
                    <pf:inputTextarea id="socialPsychiatryService"
                                      rows="10"
                                      cols="50"
                                      value="#{editStructureInformation.structureInformation.socialPsychiatryService}"
                                      readonly="#{editStructureInformation.isReadOnly()}"
                                      valueChangeListener="#{editStructureInformation.handleChange}">
                        <pf:ajax />
                    </pf:inputTextarea>
                </div>
            </div>
        </pf:fieldset>

    </ui:remove>



</ui:composition>
